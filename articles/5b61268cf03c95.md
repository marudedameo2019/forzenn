---
title: "Termuxã§pythonã‚’ä½¿ã†"
emoji: "ğŸ˜"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["android", "termux", "python", "jupyterlab", "llamacpp"]
published: true
---
https://zenn.dev/dameyodamedame/articles/937421d81b5949

ä¸Šè¨˜ã®è¨˜äº‹ã®è©³ç´°è¨˜äº‹ã§ã™ã€‚

æ—¥æœ¬ã§ã¯æœ€åˆã«æ•™ãˆã‚‹ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èªã‚’[Scratch](https://ja.wikipedia.org/wiki/Scratch_(%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%9F%E3%83%B3%E3%82%B0%E8%A8%80%E8%AA%9E))ã«ã—ã¦ã„ã‚‹å ´åˆã‚‚å¤šã„ã‚ˆã†ã§ã™ãŒã€Termuxç’°å¢ƒã¯åŸºæœ¬CLIãªã®ã§ã€å‹•ä½œã—ã¾ã›ã‚“ã€‚ãªã®ã§ã“ã“ã§ã¯æœ€åˆã«[Python](https://ja.wikipedia.org/wiki/Python)ã‚’é¸æŠã—ã¾ã™ã€‚

# Pythonã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹

```shell-session
~ $ pkg install python
```

ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ä¸­ã«ä½•ã‹èã‹ã‚ŒãŸã‚‰âã™ã‚Œã°OKã§ã™ã€‚å‹æ‰‹ã«ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®é¸æŠè‚¢ãŒé©å®œé¸ã°ã‚Œã¾ã™ã€‚

# ã‚¨ãƒ‡ã‚£ã‚¿ã§Pythonã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’æ›¸ã

nanoã‚’ä½¿ã£ã¦loop.pyã¨ã„ã†åå‰ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä»¥ä¸‹ã®å†…å®¹ã§ä½œæˆã—ã¾ã™(vimã§ä½œã‚‹å ´åˆã¯nanoã‚³ãƒãƒ³ãƒ‰ã‚’vimã‚³ãƒãƒ³ãƒ‰ã«ã™ã‚Œã°OKã§ã™)ã€‚

```shell-session
~ $ nano loop.py
```

```python:loop.py
for i in range(10):
    print(f'{i+1}å›ç›®')
```

# Pythonã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’å®Ÿè¡Œã™ã‚‹

```shell-session
~ $ python loo.py
1å›ç›®
2å›ç›®
3å›ç›®
4å›ç›®
5å›ç›®
6å›ç›®
7å›ç›®
8å›ç›®
9å›ç›®
10å›ç›®
~ $
```

ãªã‚“ã¦ã“ã¨ãªãå‹•ãã¾ã™ã‚ˆã­

# Pythonã®å­¦ç¿’ã«ã¤ã„ã¦

ã“ã“ã§Pythonã®å…¨ã¦ã‚’ç´¹ä»‹ã™ã‚‹ã¤ã‚‚ã‚Šã¯ã‚ã‚Šã¾ã›ã‚“ã€‚æ•™æã¯ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆä¸Šã®ãƒ¢ãƒã‚„AIã«é ¼ã‚Šã¾ã—ã‚‡ã†ã€‚Googleã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒå¿…è¦ã«ãªã‚Šã¾ã™ãŒã€å†…å®¹çš„ã«ã¯ä»¥ä¸‹ã®ã„ãšã‚Œã‹ãŒã‚ªã‚¹ã‚¹ãƒ¡ã§ã™ã€‚

https://www.python.jp/train/index.html
https://utokyo-ipp.github.io/

ã©ã¡ã‚‰ã‚‚[Google Colab](https://ja.wikipedia.org/wiki/Project_Jupyter#%E5%AE%9F%E8%A1%8C%E7%92%B0%E5%A2%83)ã‚’åˆ©ç”¨ã™ã‚‹ã®ã§ã€Termuxã‚’ä½¿ã‚ãšãƒ–ãƒ©ã‚¦ã‚¶ã‹ã‚‰Pythonã‚’ä½¿ã†ã‚ˆã†ãªæ„Ÿã˜ã«ãªã‚Šã¾ã™ã€‚Androidã ã¨TABãŒæŠ¼ã›ãªãã¦å›°ã‚‹ã®ã§ã€[CodeBoard Keyboard for Coding](https://play.google.com/store/apps/details?id=com.gazlaws.codeboard)ãªã©ã§è£œåŠ©ã™ã‚‹ã¨ã„ã„ã§ã—ã‚‡ã†ã€‚


# Jupyter lab

Google Colabã¯ã‚ªãƒ³ãƒ©ã‚¤ãƒ³(ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã‚¢ã‚¯ã‚»ã‚¹ãŒã‚ã‚‹çŠ¶æ…‹)ã§ãªã„ã¨ä½¿ãˆã¾ã›ã‚“ã€‚èª°ã‚‚ãŒå¸¸æ™‚ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ç’°å¢ƒã¨ã¯é™ã‚‰ãªã„ã®ã§ã€ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ã§ã‚‚ã»ã¼åŒã˜ã“ã¨ã‚’Termuxä¸Šã§å®Ÿç¾ã™ã‚‹æ‰‹æ®µã‚’ç”¨æ„ã—ã¦ã¿ã¾ã—ãŸã€‚Jupyter labã¨ã„ã†ã‚„ã¤ã§ã™ã€‚Google Colabã®å®Ÿä½“ã¯å…ˆã®èª¬æ˜ãƒªãƒ³ã‚¯ã§ç¤ºã—ãŸã¨ãŠã‚Šã€ãŸã ã®Jupyter Notebookã®å®Ÿè¡Œç’°å¢ƒãªã®ã§ã€è‡ªåˆ†ã§ç”¨æ„ã™ã‚‹ã“ã¨ã‚‚å¯èƒ½ãªã®ã§ã™ã€‚

## 1. jupyter labã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¨èµ·å‹•

```shell-session
~ $ pkg install -y build-essential libzmq rust python
~ $ pkg install -y patchelf # zmqç”¨
~ $ pkg install -y libjpeg-turbo # Pillowç”¨
~ $ pkg install -y matplotlib git
~ $ mkdir jupyter
~ $ cd jupyter
~/jupyter $ python -m venv env
~/jupyter $ . env/bin/activate # æ¯å›å¿…è¦
((env) ) ~/jupyter $ python -m pip install -U pip
((env) ) ~/jupyter $ pip install jupyter jupyterlab-language-pack-ja-JP
((env) ) ~/jupyter $ pip install Pillow matplotlib
((env) ) ~/jupyter $ patchelf --add-needed libpython3.12.so ./env/lib/python3.12/site-packages/zmq/backend/cython/_zmq.cpython-312.so # æ¯å›å¿…è¦
((env) ) ~/jupyter $ PYTHONPATH=$(python -c "import sys;print(':'.join(sys.path))";echo -n ":/data/data/com.termux/files/usr/lib/python3.12/site-packages") jupyter-lab # æ¯å›å¿…è¦ã€‚--ip='*' ã‚’ä»˜ã‘ã‚‹ã¨PCã®ãƒ–ãƒ©ã‚¦ã‚¶ã‹ã‚‰ã§ã‚‚è¦‹ã‚Œã‚‹
...(ã“ã“ã§å‡ºåŠ›ã•ã‚Œã‚‹URLã‚’ãƒ–ãƒ©ã‚¦ã‚¶ã«è²¼ã‚Šä»˜ã‘ã‚‹)
((env) ) ~/jupyter $ patchelf --remove-needed libpython3.12.so ./env/lib/python3.12/site-packages/zmq/backend/cython/_zmq.cpython-312.so # æ¯å›å¿…è¦
((env) ) ~/jupyter $ deactivate # æ¯å›å¿…è¦
~/jupyter $ 
```

â€»pip installã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§ãƒ“ãƒ«ãƒ‰ãŒå…¥ã‚‹ã“ã¨ãŒã‚ã‚Šã€ã¨ã¦ã‚‚æ™‚é–“ãŒã‹ã‹ã‚Šã¾ã™ã€‚å‹•ã‹ãªã„ã‹ã‚‰å›ºã¾ã£ãŸã¨æ€ã‚ãšã€ä½•åˆ†ã§ã‚‚å¾…ã¡ã¾ã—ã‚‡ã†ã€‚

jupyter-labã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ãŸéš›ã«è¡¨ç¤ºã•ã‚Œã‚‹URLã‚’ãƒ–ãƒ©ã‚¦ã‚¶ã«è²¼ã‚Šä»˜ã‘ã‚‹ã“ã¨ã§ã€ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ã§Google Colabã®ã‚ˆã†ãªæ©Ÿèƒ½ã‚’ä½¿ã†ã“ã¨ãŒã§ãã¾ã™ã€‚åˆå›èµ·å‹•æ™‚ã¯è‹±èªã ã¨æ€ã„ã¾ã™ãŒã€ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‹ã‚‰Settings>Language>Japanese(Japan)-æ—¥æœ¬èª(æ—¥æœ¬)ã‚’é¸æŠã™ã‚‹ã¨æ—¥æœ¬èªã«ãªã‚Šã¾ã™ã€‚

![ãƒ–ãƒ©ã‚¦ã‚¶ç”»é¢](/images/5b61268cf03c95_001.jpg)

## 2. jupyter labã®åœæ­¢

ãƒ–ãƒ©ã‚¦ã‚¶ã®ç”»é¢ã§ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‹ã‚‰ã‚·ãƒ£ãƒƒãƒˆãƒ€ã‚¦ãƒ³ã‚’é¸æŠã™ã‚‹ã‹ã€Termuxä¸Šã§Ctrl+Cã‚’è¡Œã„ã€è³ªå•ã«Yã™ã‚‹ã“ã¨ã§åœæ­¢ã§ãã¾ã™ã€‚

## 3. æ¬¡å›ä»¥é™ã®èµ·å‹•

ã‚³ãƒ¡ãƒ³ãƒˆã«æ¯å›å¿…è¦ã¨æ›¸ã„ã¦ã„ã‚‹ã‚³ãƒãƒ³ãƒ‰ã‚’æ¯å›æ‰“ã¡è¾¼ã‚€å¿…è¦ãŒã‚ã‚Šã€é¢å€’ãªã®ã§ã€ä»¥ä¸‹ã®ã‚ˆã†ãªã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ç”¨æ„ã—ã¾ã—ãŸã€‚

```sh:jupyter.sh
. env/bin/activate
patchelf --add-needed libpython3.12.so ./env/lib/python3.12/site-packages/zmq/backend/cython/_zmq.cpython-312.so
PYTHONPATH=$(python -c "import sys;print(':'.join(sys.path))";echo -n ":/data/data/com.termux/files/usr/lib/python3.12/site-packages") jupyter-lab # --ip='*' ã‚’ä»˜ã‘ã‚‹ã¨PCã®ãƒ–ãƒ©ã‚¦ã‚¶ã‹ã‚‰ã§ã‚‚è¦‹ã‚Œã‚‹
patchelf --remove-needed libpython3.12.so ./env/lib/python3.12/site-packages/zmq/backend/cython/_zmq.cpython-312.so
deactivate
```

ã“ã‚Œã‚’ä½¿ã†ã¨æ¬¡å›ä»¥é™ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«èµ·å‹•ã§ãã¾ã™ã€‚

```shell-session
~/jupyter $ sh jupyter.sh
```

# llama-cpp-pythonã‚’ä½¿ã£ã¦ã¿ã‚‹

ä¸€é€šã‚ŠPythonã®å­¦ç¿’ãŒçµ‚ã‚ã£ãŸã‚‰ã€Pythonã®å¾—æ„åˆ†é‡ã§ã‚‚ã‚ã‚‹è¨ˆç®—ç³»ã®å‡¦ç†ã§ã‚‚ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚ä»Šå›ã¯ã‚¹ãƒãƒ›ã§[LLM](https://ja.wikipedia.org/wiki/%E5%A4%A7%E8%A6%8F%E6%A8%A1%E8%A8%80%E8%AA%9E%E3%83%A2%E3%83%87%E3%83%AB)ã‚’ã—ã¦ã¿ã¾ã™ã€‚ã‚ã¾ã‚Šå¤§ããªãƒ¢ãƒ‡ãƒ«ã‚’ä½¿ã£ã¦ã„ã¾ã›ã‚“ãŒã€ãã‚Œã§ã‚‚1.9GBãã‚‰ã„ã¯ã‚ã‚‹ã®ã§ã€ãã‚Œãªã‚Šã®ã‚¹ãƒšãƒƒã‚¯ã®ã‚¹ãƒãƒ›ã§ãªã‚“ã¨ã‹å‹•ãã¨ã„ã†ãƒ¬ãƒ™ãƒ«ã§ã™ã€‚

ã—ã‹ã—å‹•ãã‹ã©ã†ã‹ã®ç¢ºèªã®ãŸã‚ã«ã‚‚ã€ä¸€å¿œç”¨æ„ã•ã›ã¦ã‚‚ã‚‰ã„ã¾ã—ãŸã€‚

https://github.com/abetlen/llama-cpp-python
https://huggingface.co/unsloth/Qwen3-4B-GGUF

## 1. å®Ÿè¡Œç’°å¢ƒæ§‹ç¯‰

```shell-session
~ $ mkdir -p python/llama_example
~ $ cd python/llama_example
~/python/llama_example $ python -m venv env
~/python/llama_example $ . env/bin/activate
((env) ) ~/python/llama_example $ python -m pip install -U pip
((env) ) ~/python/llama_example $ pip install llama-cpp-python huggingface-hub

```

```python:foo.py
from llama_cpp import Llama
import time

llm = Llama.from_pretrained(
    repo_id="unsloth/Qwen3-4B-GGUF",
    filename="Qwen3-4B-Q3_K_S.gguf",
    verbose=False
)

while True:
    q = input('è³ªå•: ')
    if q == 'çµ‚äº†':
        break
    s = time.perf_counter()
    output = llm(
          f"è³ªå•: {q}\n",
          max_tokens=1024,
          stop=["è³ªå•:", "\n"],
          echo=False
    )
    e = time.perf_counter()
    print(f'({e-s:.2f}[ç§’])')
    print(output["choices"][0]["text"])

```

## 2. å®Ÿè¡Œ

```shell-session
((env) ) ~/python/llama_example $ python foo.py
llama_context: n_ctx_per_seq (512) < n_ctx_train (40960) -- the full capacity of the model will not be utilized
è³ªå•: LLMã‚’ä¸Šæ‰‹ã«ä½¿ã†ã‚³ãƒ„ã‚’æ•™ãˆã¦ãã ã•ã„ã€‚
(65.86[ç§’])
å›ç­”: 1. æ¥µåŠ›è‡ªç„¶ãªæ—¥æœ¬èªã§è©±ã—ã¦ã€LLMãŒç†è§£ã—ã‚„ã™ã„ã‚ˆã†ã«ã€æ–‡ã®æ§‹é€ ã‚’ã‚·ãƒ³ãƒ—ãƒ«ã«ã—ã¦ãã ã•ã„ã€‚2. ãã®å ´ãã®å ´ã®çŠ¶æ³ã‚’å…·ä½“çš„ã«èª¬æ˜ã—ã¦ãã ã•ã„ã€‚3. é‡è¦ãªæƒ…å ±ã‚’å…ˆã«ä¼ãˆã¦ã‹ã‚‰ã€èƒŒæ™¯ã‚„è©³ç´°ã‚’è¿½åŠ ã—ã¦ãã ã•ã„ã€‚4. éå»ã®ä¼šè©±ã‚„ä¸Šä¸‹æ–‡ã‚’æ´»ç”¨ã—ã¦ãã ã•ã„ã€‚5. ã‚ãªãŸã®æ„å›³ã‚’æ˜ç¢ºã«ã—ã€LLMãŒãã®æ„å›³ã‚’æ­£ç¢ºã«ç†è§£ã§ãã‚‹ã‚ˆã†ã€æŒ‡ç¤ºã‚’æ˜ç¢ºã«ã—ã¦ãã ã•ã„ã€‚6. é•·æ–‡ã¯é¿ã‘ã€æ®µéšçš„ã«è©±ã—ã¦ãã ã•ã„ã€‚7. ä½¿ ã„ãŸã„è¨€è‘‰ãŒãªã‘ã‚Œã°ã€æ–°ã—ã„å˜èªã‚„å°‚é–€ç”¨èªã¯ä½¿ã‚ãšã€æ¯å›åŒã˜å‚æ•°èªã§èª¬æ˜ã—ã¦ãã ã•ã„ã€‚
è³ªå•: çµ‚äº†
((env) ) ~/python/llama_example $

```
â€»åˆå›ã¯ãƒ¢ãƒ‡ãƒ«ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ç´„1.9GBãŒå…¥ã‚‹ã®ã§ã€Wi-Fiãªã©ã®ç’°å¢ƒã§è¡Œã£ã¦ãã ã•ã„

ã“ã‚“ãªæ„Ÿã˜ã§ã€ã‚¹ãƒãƒ›ã§ã‚‚ãƒ­ãƒ¼ã‚«ãƒ«LLMãŒå‹•ãã¾ã™ã€‚ä½¿ç”¨ã—ã¦ã„ã‚‹ãƒ¢ãƒ‡ãƒ«ãŒä¸­å›½è£½ãªã®ã§ã€ãŸã¾ã«ä¸æ€è­°ãªæ¼¢å­—ã«ãªã‚‹ã®ã¯å¾¡æ„›å¬Œã§ã™ã€‚

è³ªå•ã™ã‚‹éš›ã«ã€Œçµ‚äº†ã€ã¨æ‰“ã¡è¾¼ã‚ã°çµ‚ã‚ã‚Šã¾ã™(æ™®é€šã«Ctrl+Cã§ã‚‚æ­¢ã¾ã‚‹)

## 3. å¾Œå§‹æœ«

```shell-session
((env) ) ~/python/llama_example $ deactivate
~/python/llama_example $ 
```

## 4. æœ€å¾Œã«

å®Ÿç”¨ä¸Šã¯2025å¹´5æœˆç¾åœ¨Gemini2.0ãŒç„¡æ–™ã‹ã¤èªè¨¼ãªã—ã§ä½¿ãˆã‚‹ã®ã§ã€çŸ¥ã‚ŠãŸã„ã“ã¨ãŒã‚ã‚‹ãªã‚‰åŸºæœ¬ã¯ãã¡ã‚‰ã‚’ä½¿ãˆã°ã„ã„ã§ã—ã‚‡ã†ã€‚ã›ã„ãœã„ãƒãƒƒãƒˆãŒãªã„ã¨ã“ã‚ã§ã‚¨ã‚»ç¿»è¨³ã‚’ã—ãŸã„ã¨ããªã©ã«ä½¿ãˆã‚‹ã‹ã‚‚ã—ã‚Œãªã„ãã‚‰ã„ã§ã™ã€‚ã¾ã‚ä»•çµ„ã¿ã‚’ç†è§£ã™ã‚‹å‰ã«ã¾ãšã¯è‡ªåˆ†ã§å‹•ã‹ã™çµŒé¨“ã¯å¤§äº‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚LLMã®ä½¿ã„æ–¹ã‚’è¦šãˆã‚‹ã ã‘ãªã‚‰ã‚ã–ã‚ã–ã‚„ã‚‹å¿…è¦ã¯ãªã„ã‹ã‚‚ã§ã™(ç°¡å˜ãªã®ã§)ã€‚
