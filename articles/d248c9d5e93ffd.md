---
title: "Termuxã§PHP"
emoji: "ğŸ¦”"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["android", "termux", "php", "nginx"]
published: false
---
@[card](https://zenn.dev/dameyodamedame/articles/937421d81b5949)

ä¸Šè¨˜ã®è¨˜äº‹ã®è©³ç´°è¨˜äº‹ã§ã™ã€‚

# phpé–¢é€£ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```shell-session
~ $ pkg install nginx php-fpm
```

[nginx](https://ja.wikipedia.org/wiki/Nginx)ã¯æœ‰åãªWebã‚µãƒ¼ãƒãƒ¼ã§ã™ã€‚
[php-fpm](https://www.php.net/manual/ja/install.fpm.php)ã¯PHPã«ãŠã‘ã‚‹[FastCGI](https://ja.wikipedia.org/wiki/FastCGI)å®Ÿè£…ã§ã™ã€‚Termuxã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¨ã—ã¦ã¯ã€ä¸€ç·’ã«phpã‚‚å…¥ã‚Šã¾ã™ã€‚

# nginxã®è¨­å®š

@[card](https://nginx.org/en/docs/beginners_guide.html)

ã¾ãšã¯nginxãŒphp-fpmã‚’å‘¼ã¹ã‚‹ã‚ˆã†ã«è¨­å®šã—ã¾ã™ã€‚

```nginx:$PREFIX/etc/nginx/nginx.conf
        server_name  localhost;
```

ã¨ã„ã†éƒ¨åˆ†ã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«å¤‰ãˆã¾ã™ã€‚

```nginx:$PREFIX/etc/nginx/nginx.conf
        server_name  localhost;
        # è¿½åŠ 
        root         /data/data/com.termux/files/usr/share/nginx/html;
```

ã‚µãƒ¼ãƒãƒ¼ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ ¼ç´å ´æ‰€ã‚’

`$PREFIX/share/nginx/html`

ã«è¨­å®šã—ã¦ã„ã¾ã™ã€‚

ã•ã‚‰ã«ä»¥ä¸‹ã®éƒ¨åˆ†ã‚’

```nginx:$PREFIX/etc/nginx/nginx.conf
        location / {
            root   /data/data/com.termux/files/usr/share/nginx/html;
            index  index.html index.htm;
        }
```

ã¨ã„ã†éƒ¨åˆ†ã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«å¤‰ãˆã¾ã™ã€‚

```nginx:$PREFIX/etc/nginx/nginx.conf
        location / {
            #root   /data/data/com.termux/files/usr/share/nginx/html;
            #index  index.html index.htm;
            index  index.html index.htm index.php;
        }
```

/ã§çµ‚ã‚ã‚‹URLã§/index.phpã‚‚è¦‹ã«è¡Œãã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

ã•ã‚‰ã«ä»¥ä¸‹ã®éƒ¨åˆ†ã‚’

```nginx:$PREFIX/etc/nginx/nginx.conf
        location = /50x.html {
            root   /data/data/com.termux/files/usr/share/nginx/html;
        }
```

ã¨ã„ã†éƒ¨åˆ†ã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«å¤‰ãˆã¾ã™ã€‚

```nginx:$PREFIX/etc/nginx/nginx.conf
        location = /50x.html {
            #root   /data/data/com.termux/files/usr/share/nginx/html;
        }
```

rootã®è¨­å®šã‚’çµ±ä¸€ã™ã‚‹ãŸã‚ã«ã‚³ãƒ¡ãƒ³ãƒˆã«ã—ã¦ã„ã¾ã™ã€‚

ã•ã‚‰ã«ä»¥ä¸‹ã®éƒ¨åˆ†ã‚’

```nginx:$PREFIX/etc/nginx/nginx.conf
        #location ~ \.php$ {
        #    root           html;
        #    fastcgi_pass   127.0.0.1:9000;
        #    fastcgi_index  index.php;
        #    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;
        #    include        fastcgi_params;
        #}
```

ä»¥ä¸‹ã®ã‚ˆã†ã«å¤‰ãˆã¾ã™ã€‚

```nginx:$PREFIX/etc/nginx/nginx.conf
        #location ~ \.php$ {
        #    root           html;
        #    fastcgi_pass   127.0.0.1:9000;
        #    fastcgi_index  index.php;
        #    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;
        #    include        fastcgi_params;
        #}
        location ~ \.php$ {
            fastcgi_pass   unix:/data/data/com.termux/files/usr/var/run/php-fpm.sock;
            fastcgi_index  index.php;
            fastcgi_param  SCRIPT_FILENAME $document_root$fastcgi_script_name;
            include        fastcgi_params;
        }
```

ã“ã‚ŒãŒå—ã‘æ¸¡ã—ã®è¨­å®šã§ã™ã€‚ã“ã®php-fpmã¯Unixãƒ‰ãƒ¡ã‚¤ãƒ³ã‚½ã‚±ãƒƒãƒˆã§å‹•ã„ã¦ã‚‹ã®ã§ã€ãã¡ã‚‰ã«å¿…è¦ãªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æ¸¡ã™è¨­å®šã«ãªã‚Šã¾ã™ã€‚

# PHP(web)ã‚’å‹•ã‹ã™

ä¸¡ã‚µãƒ¼ãƒ“ã‚¹ã‚’(æ‰‹å‹•)èµ·å‹•ã™ã‚‹ã ã‘ã§ã™ã€‚
nginxã¯æ‹¡å¼µå­ãŒ.phpã®ãƒ•ã‚¡ã‚¤ãƒ«ã®å ´åˆã€php-fpmã«å‡¦ç†ã‚’ä»»ã›ã¾ã™ã€‚

```shell-session
~ $ nginx
~ $ php-fpm
```

ã©ã¡ã‚‰ã‚‚ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã§å‹•ãã®ã§ã€ã“ã‚Œã§èµ·å‹•å®Œäº†ã§ã™ã€‚

## nginxå‹•ä½œç¢ºèª

ãƒ–ãƒ©ã‚¦ã‚¶ã‹ã‚‰ http://localhost:8080/ ã‚’é–‹ã‘ã°nginxã®å‹•ä½œç¢ºèªãŒã§ãã¾ã™ã€‚

![nginxèµ·å‹•ç”»é¢](/images/d248c9d5e93ffd_001.jpg)

## php-fpmå‹•ä½œç¢ºèª

$PREFIX/share/nginx/html/info.php ã‚’ä»¥ä¸‹ã®å†…å®¹ã§ä½œæˆã—ã¾ã™ã€‚

```php:$PREFIX/share/nginx/html/info.php
<?php
phpinfo();
?>
```

ãƒ–ãƒ©ã‚¦ã‚¶ã‹ã‚‰ http://localhost:8080/info.php ã‚’é–‹ã‘ã°php-fpmã¨phpã®å‹•ä½œç¢ºèªãŒã§ãã¾ã™ã€‚

![phpç¢ºèªç”»é¢](/images/d248c9d5e93ffd_002.jpg)

# PHP(web)ã‚’åœæ­¢ã™ã‚‹

```shell-session
~ $ pkill nginx
~ $ pkill php-fpm
```

