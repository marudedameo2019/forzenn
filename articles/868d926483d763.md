---
title: "Termuxã§WordPress"
emoji: "ğŸ¤–"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["android", "termux", "wordpress"]
published: true
---
@[card](https://zenn.dev/dameyodamedame/articles/937421d81b5949)

ä¸Šè¨˜ã®è¨˜äº‹ã®è©³ç´°è¨˜äº‹ã§ã™ã€‚

ã“ã“ã¾ã§ã§MariaDBã¨PHPãŒå‹•ä½œã™ã‚‹ã‚ˆã†ã«ãªã£ãŸã®ã§ã€WordPressã‚’è¨­ç½®ã—ã¾ã™ã€‚[wp-cli](https://wp-cli.org/ja/)ã‚’ä½¿ã£ãŸæ–¹æ³•ã§ã™ã€‚

# wp-cliã®è¨­ç½®

ã¾ãšã¯wp-cliã®[phar](https://www.php.net/manual/ja/book.phar.php)ã‚’å–å¾—ã—ã¾ã™ã€‚

```shell-session
~ $ curl -O https://raw.githubusercontent.com/wp-cli/builds/gh-pages/phar/wp-cli.phar
~ $ php wp-cli.phar --info
OS:	Linux 4.19.113-perf-gfe0bf86775e1 #1 SMP PREEMPT Wed Aug 31 00:10:19 CST 2022 aarch64
Shell:	/data/data/com.termux/files/usr/bin/bash
PHP binary:	/data/data/com.termux/files/usr/bin/php
PHP version:	8.4.2
php.ini used:	
MySQL binary:	/data/data/com.termux/files/usr/bin/mariadb
MySQL version:	/data/data/com.termux/files/usr/bin/mariadb from 11.8.0-MariaDB, client 15.2 for Android (aarch64) using  EditLine wrapper
...
~ $
```

å¤§ä½“åˆã£ã¦ã„ã‚‹ã‚ˆã†ãªã®ã§ã€`$PREFIX/local/bin`ã«wpã‚³ãƒãƒ³ãƒ‰ã¨ã—ã¦è¨­ç½®ã—ã¾ã™ã€‚

```shell-session
~ $ chmod u+x wp-cli.phar
~ $ mkdir -p $PREFIX/local/bin
~ $ mv wp-cli.phar $PREFIX/local/bin/wp
```

æ®‹å¿µãªãŒã‚‰ãƒ‘ã‚¹ãŒé€šã£ã¦ãŠã‚‰ãšã€ä»»æ„ã®å ´æ‰€ã‹ã‚‰wpã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ãˆãªã„ã®ã§ã€ãƒ‘ã‚¹ã‚’é€šã—ã¦ãŠãã¾ã™ã€‚

```bash:$HOME/.bashrc
if [[ ":$PATH:" != *":$PREFIX/local/bin:"* ]]; then
    PATH+=":$PREFIX/local/bin"
fi
```

wpã‚³ãƒãƒ³ãƒ‰ã‚’/usr/local/binã«è¨­ç½®ã—ã€PATHç’°å¢ƒå¤‰æ•°ã«/usr/local/binã‚’è¿½åŠ ã™ã¹ãã€$HOME/.bashrcã‚’è¿½åŠ ã—ãŸã®ã§ã€ä¸€åº¦termuxã‚’çµ‚äº†ã—ã¦ã€æ–°ã—ãç«¯æœ«ã‚’èµ·å‹•ã—ã¦ã‹ã‚‰ä»¥ä¸‹ã‚’å¼•ãç¶šãå®Ÿæ–½ã—ã¾ã™ã€‚

```shell-session
~ $ wp --info
(å…ˆç¨‹ã¨åŒæ§˜ã®å‡ºåŠ›ã§ã‚ã‚‹ã“ã¨ã‚’ç¢ºèª)
```

# WordPressã®è¨­ç½®

WordPressã®ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ã„ã¾ã™ã€‚

```shell-session
~ $ mkdir -p wordpress
~ $ cd wordpress
~/wordpress $ php -d memory_limit=512M "$(which wp)" core download --locale=ja
```

æ™®é€šã«å®Ÿè¡Œã™ã‚‹ã¨ãƒ¡ãƒ¢ãƒªè¨±å®¹é‡ã‚’è¶…ãˆã¦ã—ã¾ã†ã®ã§ã€ä¸€æ™‚çš„ã«ãã®åˆ¶é™ã‚’512MBã¾ã§ä¸Šã’ã¦å®Ÿè¡Œã—ã¦ã„ã¾ã™ã€‚

æ¬¡ã¯MariaDBãŒç¨¼åƒã—ã¦ã„ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚MariaDBä¸Šã«ãƒ¦ãƒ¼ã‚¶ãƒ¼`wordpress`ã‚’ä½œæˆã—ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹`wordpress`ã«å¯¾ã—ã¦å…¨æ¨©é™ã‚’ä¸ãˆã¦ã„ã¾ã™ã€‚ã“ã®æ™‚ç‚¹ã§ã¯ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹`wordpress`ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚

```shell-session
~/wordpress $ mariadb -u root mysql
...
MariaDB [mysql]> create user 'wordpress'@'localhost' identified by 'wppass';
Query OK, 0 rows affected (0.008 sec)

MariaDB [mysql]> grant all privileges on wordpress.* to 'wordpress'@'localhost';
Query OK, 0 rows affected (0.014 sec)

MariaDB [mysql]> FLUSH PRIVILEGES;
Query OK, 0 rows affected (0.006 sec)

MariaDB [mysql]> exit
Bye
```

ä½œæˆã—ãŸãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’æŒ‡å®šã—ã¦WordPressã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œã‚Šã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ä½œã‚‰ã›ã€WordPressç¨¼åƒã«å¿…è¦ãªæƒ…å ±ã‚’è¨­å®šã—ã¦ã„ãã¾ã™ã€‚

```shell-session
~/wordpress $ wp config create --dbhost=localhost:/data/data/com.termux/files/usr/var/run/mysqld.sock --dbname=wordpress --dbuser=wordpress --dbpass=wppass
Success: Generated 'wp-config.php' file.
~/wordpress $ wp db create
Success: Database created.
~/wordpress $ wp core install --url=localhost:8080 --title="ãƒ†ã‚¹ãƒˆWordPress" --admin_user=wpcli --admin_password=wpcli --admin_email=ãƒ¦ãƒ¼ã‚¶ãƒ¼å@æœ‰åŠ¹ãªãƒ‰ãƒ¡ã‚¤ãƒ³
Success: WordPress installed successfully.
```

ã“ã‚Œã§æ—¥æœ¬èªç‰ˆã®WordPressã®ç¨¼åƒã«å¿…è¦ãªãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚«ãƒ¬ãƒ³ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ç½®ãã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚‚æº–å‚™ã™ã‚‹ã“ã¨ãŒå‡ºæ¥ã¾ã—ãŸ(ãŸã ã—localhostã‚’URLã¨ã—ã¦ã„ã‚‹ã®ã§ã€ä»–ã®ãƒ›ã‚¹ãƒˆã‹ã‚‰ã¯ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã›ã‚“ã€‚ãƒ¢ãƒã‚¤ãƒ«ãªã®ã§ã€ã“ã“ã¯å‰²ã‚Šåˆ‡ã‚‹ã“ã¨ã«ã—ã¾ã—ãŸã€‚hostãƒ•ã‚¡ã‚¤ãƒ«ãªã©ã‚’ä½¿ã„ã‚¢ã‚¯ã‚»ã‚¹ã—ã€ãã®åå‰ã‚’ãƒãƒ¼ãƒãƒ£ãƒ«ãƒ›ã‚¹ãƒˆã«ã™ã‚‹ã“ã¨ã§è¨­å®šã¯å¯èƒ½ã§ã™)ã€‚ã‚ã¨ã¯nginxã®rootè¨­å®šã‚’å¤‰ãˆã‚‹ã ã‘ã§ã™ã€‚

```nginx:$PREFIX/etc/nginx/nginx.conf
        root         /data/data/com.termux/files/usr/share/nginx/html;
```

ã“ã‚Œã‚’ä»¥ä¸‹ã«æ›¸ãæ›ãˆã¦ã€

```nginx:$PREFIX/etc/nginx/nginx.conf
        #root         /data/data/com.termux/files/usr/share/nginx/html;
        root /data/data/com.termux/files/home/wordpress;
```

ã™ã§ã«nginx/php-fpmãŒèµ·å‹•ä¸­ãªã‚‰nginxã‚’å†èµ·å‹•ã™ã‚‹ã ã‘ã§ã™ã€‚

```shell-session
~/wordpress $ pkill nginx
~/wordpress $ nginx
```

ã‚¹ãƒãƒ›ã®ãƒ–ãƒ©ã‚¦ã‚¶ã‹ã‚‰"localhost:8080"ã‚’é–‹ã„ã¦ã¿ã¦ãã ã•ã„ã€‚WordPressã®ç”»é¢ãŒå‡ºã¦ãã‚‹ã¨æ€ã„ã¾ã™ã€‚å‡ºã¦ããŸã‚‰ã€"localhost:8080/wp-login.php"ã‹ã‚‰wpcli/wpcliã§ãƒ­ã‚°ã‚¤ãƒ³ã™ã‚‹ã¨ç®¡ç†è€…ç”»é¢ãŒå‡ºã¦ãã¾ã™ã€‚ãã“ã§è¨˜äº‹ã‚’é©å½“ã«æ›¸ã„ã¦è¡¨ç¤ºã•ã›ãŸç”»é¢ãŒä»¥ä¸‹ã«ãªã‚Šã¾ã™ã€‚

![WordPressç¢ºèªç”»é¢](/images/868d926483d763_001.jpg)

